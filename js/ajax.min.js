function ajaxloadPageInit(a){jQuery(a+"a").click(function(a){if(1==ajaxcheck_ignore(this.href,this)){a.preventDefault(),this.blur();this.title||this.name||"",this.rel||!1;try{ajaxclick_code(this)}catch(t){}ajaxloadPage(this.href)}}),jQuery("."+ajaxsearch_class).each(function(a){jQuery(this).attr("action")&&(ajaxsearchPath=jQuery(this).attr("action"),jQuery(this).submit(function(){return submitSearch(jQuery(this).serialize()),!1}))}),jQuery("."+ajaxsearch_class).attr("action")}function ajaxloadPage(a,t,e){if(!ajaxisLoad){if(1==ajaxscroll_top&&jQuery("html,body").animate({scrollTop:0},1500),ajaxisLoad=!0,ajaxstarted=!0,nohttp=a.replace("http://","").replace("https://",""),firstsla=nohttp.indexOf("/"),pathpos=a.indexOf(nohttp),path=a.substring(pathpos+firstsla),1!=t&&"function"==typeof window.history.pushState){var n={foo:1e3+1001*Math.random()};history.pushState(n,"ajax page loaded...",path)}jQuery("body").append(ajaxloading_code),jQuery("#"+ajaxcontent).fadeTo("slow",.4,function(){jQuery("#"+ajaxcontent).fadeIn("slow",function(){jQuery.ajax({type:"GET",url:a,data:e,cache:!1,dataType:"html",success:function(t){ajaxisLoad=!1;var n=t.split("</title>",2);if(n.length>=2){t=n[1];var o=n[0].split("<title>")[1];jQuery(document).attr("title",jQuery("<div/>").html(o).text())}if(1==ajaxtrack_analytics&&"undefined"!=typeof _gaq&&(e="undefined"==typeof e?"":"?"+e,_gaq.push(["_trackPageview",path+e])),t=t.split('id="'+ajaxcontent+'"')[1],!t)return void(location.href=a);t=t.substring(t.indexOf(">")+1);for(var r=1,c="";r>0;){for(temp=t.split("</div>")[0],i=0,pos=temp.indexOf("<div");-1!=pos;)i++,pos=temp.indexOf("<div",pos+1);r=r+i-1,c=c+t.split("</div>")[0]+"</div>",t=t.substring(t.indexOf("</div>")+6)}document.getElementById(ajaxcontent).innerHTML=c,jQuery("#"+ajaxcontent).css("position","absolute"),jQuery("#"+ajaxcontent).css("left","20000px"),jQuery("#"+ajaxcontent).show(),ajaxloadPageInit("#"+ajaxcontent+" "),1==ajaxreloadDocumentReady&&jQuery(document).trigger("ready");try{ajaxreload_code()}catch(s){}jQuery("#"+ajaxcontent).hide(),jQuery("#"+ajaxcontent).css("position",""),jQuery("#"+ajaxcontent).css("left",""),jQuery("#"+ajaxcontent).fadeTo("slow",1,function(){}),jQuery(".spinner").remove()},error:function(a,t,e){ajaxisLoad=!1,document.title="Error loading requested page!",document.getElementById(ajaxcontent).innerHTML=ajaxloading_error_code}})})})}}function submitSearch(a){ajaxisLoad||ajaxloadPage(ajaxsearchPath,0,a)}function ajaxcheck_ignore(a,t){if(0!==t.href.indexOf(ajax.home)&&0!==t.href.indexOf("/"))return!1;if("_blank"===t.target)return!1;for(var e in ajaxignore)if(a.indexOf(ajaxignore[e])>=0)return!1;return!0}function ajaxreload_code(){jQuery("article.full-width").length?jQuery("#container").addClass("full-width"):jQuery("#container").removeClass("full-width"),"function"==typeof text_autospace_init&&text_autospace_init(),initgallary(),"function"==typeof initSlim&&initSlim(),refresh_qrimg(),add_views()}function ajaxclick_code(a){jQuery("ul.nav li").each(function(){jQuery(this).removeClass("current-menu-item")}),jQuery(a).parents("li").addClass("current-menu-item")}var ajaxcontent="content",ajaxsearch_class="searchform",ajaxignore_string=new String("#, /wp-, .pdf, .zip, .rar, /share"),ajaxignore=ajaxignore_string.split(", "),ajaxtrack_analytics=!1,ajaxscroll_top=!0,ajaxloading_code='<div class="spinner"></div>',ajaxloading_error_code='<div class="box"><p style="padding:20px;">出错啦，请刷新当前页面。</p></div>',ajaxreloadDocumentReady=!1,ajaxisLoad=!1,ajaxstarted=!1,ajaxsearchPath=null,ajaxua=jQuery.browser;jQuery(document).ready(function(){ajaxloadPageInit("")}),window.onpopstate=function(a){ajaxstarted===!0&&1==ajaxcheck_ignore(document.location.toString())&&ajaxloadPage(document.location.toString(),1)};